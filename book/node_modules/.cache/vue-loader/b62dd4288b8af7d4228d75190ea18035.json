{"remainingRequest":"/Users/gaga/Desktop/文档/vue/Books/book/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/gaga/Desktop/文档/vue/Books/book/src/views/Bookinfo.vue?vue&type=style&index=0&id=a2946012&scoped=true&lang=css&","dependencies":[{"path":"/Users/gaga/Desktop/文档/vue/Books/book/src/views/Bookinfo.vue","mtime":1585721362277},{"path":"/Users/gaga/Desktop/文档/vue/Books/book/node_modules/css-loader/dist/cjs.js","mtime":1573815120679},{"path":"/Users/gaga/Desktop/文档/vue/Books/book/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1573815121359},{"path":"/Users/gaga/Desktop/文档/vue/Books/book/node_modules/postcss-loader/src/index.js","mtime":1573815121151},{"path":"/Users/gaga/Desktop/文档/vue/Books/book/node_modules/cache-loader/dist/cjs.js","mtime":1573815120526},{"path":"/Users/gaga/Desktop/文档/vue/Books/book/node_modules/vue-loader/lib/index.js","mtime":1573815121359}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5sb2FkaW5nIHsKICBwYWRkaW5nLXRvcDogMTAlOwogIGRpc3BsYXk6IGZsZXg7CiAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgYWxpZ24taXRlbXM6IGNlbnRlcjsKfQouZGVtby1zcGluLWNvbCB7CiAgZm9udC1zaXplOiAyMnB4OwogIGhlaWdodDogMTAwcHg7CiAgcG9zaXRpb246IHJlbGF0aXZlOwp9Ci5kZW1vLXNwaW4taWNvbi1sb2FkIHsKICBmb250LXNpemU6IDMwcHg7CiAgYW5pbWF0aW9uOiBhbmktZGVtby1zcGluIDFzIGxpbmVhciBpbmZpbml0ZTsKfQpAa2V5ZnJhbWVzIGFuaS1kZW1vLXNwaW4gewogIGZyb20gewogICAgdHJhbnNmb3JtOiByb3RhdGUoMGRlZyk7CiAgfQogIDUwJSB7CiAgICB0cmFuc2Zvcm06IHJvdGF0ZSgxODBkZWcpOwogIH0KICB0byB7CiAgICB0cmFuc2Zvcm06IHJvdGF0ZSgzNjBkZWcpOwogIH0KfQoubWFpbiB7CiAgcGFkZGluZzogMTBweDsKICBib3gtc2l6aW5nOiBib3JkZXItYm94Owp9Ci50b3BsaXN0IHsKICBkaXNwbGF5OiBmbGV4Owp9Ci5wYWdlIHsKICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgbWFyZ2luOiAxMHB4IDA7Cn0K"},{"version":3,"sources":["Bookinfo.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0VA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Bookinfo.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"all\">\n    <!-- <div class=\"loading\" v-if=\"isLoading\">\n      <Col class=\"demo-spin-col\" span=\"8\">\n        <Spin fix>\n          <Icon type=\"ios-loading\" size=\"40\" class=\"demo-spin-icon-load\"></Icon>\n          <div>Loading</div>\n        </Spin>\n      </Col>\n    </div>-->\n    <div class=\"main\" v-if=\"!isLoading\">\n      <div class=\"toplist\">\n        <Dropdown :style=\"{margin: '0 10px 10px 0px'}\" @on-click=\"selectType\">\n          <Button type=\"primary\">\n            {{typeName ? typeName : \"选择类别\" }}\n            <Icon type=\"ios-arrow-down\"></Icon>\n          </Button>\n          <DropdownMenu slot=\"list\" v-for=\"(item,index) in typeList\" :key=\"index\">\n            <DropdownItem :name=\"item\">{{item}}</DropdownItem>\n          </DropdownMenu>\n        </Dropdown>\n        <Dropdown :style=\"{margin: '0 10px 10px 5px'}\" @on-click=\"selectLanguage\">\n          <Button type=\"primary\">\n            {{languageName ? languageName : \"选择语言\" }}\n            <Icon type=\"ios-arrow-down\"></Icon>\n          </Button>\n          <DropdownMenu slot=\"list\" v-for=\"(item,index) in languageList\" :key=\"index\">\n            <DropdownItem :name=\"item\">{{item}}</DropdownItem>\n          </DropdownMenu>\n        </Dropdown>\n        <Dropdown :style=\"{margin: '0 10px 10px 5px'}\" @on-click=\"selectStatus\">\n          <Button type=\"primary\">\n            {{statusName ? statusName : \"选择状态\" }}\n            <Icon type=\"ios-arrow-down\"></Icon>\n          </Button>\n          <DropdownMenu slot=\"list\" v-for=\"(item,index) in statusList\" :key=\"index\">\n            <DropdownItem :name=\"item\">{{item}}</DropdownItem>\n          </DropdownMenu>\n        </Dropdown>\n        <Button :style=\"{marginLeft:'5px'}\" type=\"primary\" @click=\"selectAll\">全部信息</Button>\n        <Button :style=\"{marginLeft:'15px'}\" type=\"primary\" @click=\"bookAdd=true\">添加新书</Button>\n        <Input\n          v-model=\"bookname\"\n          :style=\"{width: 'auto',marginLeft: '15px'}\"\n          search\n          enter-button\n          placeholder=\"搜索书名...\"\n          @on-search=\"searchName\"\n        />\n      </div>\n\n      <Table border :columns=\"columns\" :data=\"showdata\"></Table>\n      <div class=\"page\">\n        <Page\n          class=\"page\"\n          :total=\"total\"\n          show-total\n          :current.sync=\"currentPage\"\n          :page-size=\"pageSize\"\n          @on-change=\"changePage\"\n        />\n      </div>\n    </div>\n\n    <Modal v-model=\"bookDetail\" width=\"500\">\n      <p slot=\"header\" style=\"text-align:center\">\n        <!-- <Icon type=\"ios-information-circle\"></Icon> -->\n        <span>修改书籍</span>\n      </p>\n      <div>\n        <BookDetail\n          @toParent=\"selectAll\"\n          @closeMod=\"closeMod\"\n          :bookDatas=\"boodataAsync\"\n          :typeList=\"typeList\"\n          :languageList=\"languageList\"\n          :statusList=\"statusList\"\n          v-if=\"JSON.stringify(boodataAsync) !== '{}'\"\n        ></BookDetail>\n      </div>\n      <div slot=\"footer\"></div>\n    </Modal>\n    <Modal v-model=\"bookAdd\" width=\"500\">\n      <p slot=\"header\" style=\"text-align:center\">\n        <!-- <Icon type=\"ios-information-circle\"></Icon> -->\n        <span>添加书籍</span>\n      </p>\n      <div>\n        <BookAdd\n          @toParent=\"selectAll\"\n          @closeMod=\"closeMod\"\n          v-if=\"bookAdd\"\n          :typeList=\"typeList\"\n          :languageList=\"languageList\"\n          :statusList=\"statusList\"\n        ></BookAdd>\n      </div>\n      <div slot=\"footer\"></div>\n    </Modal>\n  </div>\n</template>\n\n<script>\nimport { data } from \"@/api/data.js\";\nimport BookDetail from \"@/components/bookinfo/bookdetail\";\nimport BookAdd from \"@/components/bookinfo/bookadd\";\nimport { getBook, delBook } from \"@/api/index.js\";\nimport axios from \"axios\";\n\nexport default {\n  components: {\n    BookDetail,\n    BookAdd\n  },\n  data() {\n    return {\n      isLoading: true,//进度条\n      bookDetail: false,//是否显示编辑图书\n      bookAdd: false,//是否显示添加图书\n      boodataAsync: {}, //书籍详情数据\n      columns: [\n        {\n          title: \"ID\",\n          key: \"id\",\n          align: \"center\"\n        },\n        {\n          title: \"书名\",\n          key: \"name\",\n          align: \"center\"\n        },\n        {\n          title: \"类别\",\n          key: \"type\",\n          align: \"center\"\n        },\n        {\n          title: \"语言\",\n          key: \"language\",\n          align: \"center\"\n        },\n        {\n          title: \"价格(¥)\",\n          key: \"price\",\n          align: \"center\"\n        },\n        {\n          title: \"数量\",\n          key: \"number\",\n          align: \"center\"\n        },\n        {\n          title: \"状态\",\n          key: \"status\",\n          align: \"center\",\n          render: (h, params) => {\n            if (params.row.status == \"已上架\") {\n              return h(\"p\", { style: { color: \"green\" } }, params.row.status);\n            } else {\n              return h(\"p\", { style: { color: \"red\" } }, params.row.status);\n            }\n          }\n        },\n        {\n          title: \"操作\",\n          key: \"action\",\n          width: 150,\n          align: \"center\",\n          render: (h, params) => {\n            return h(\"div\", [\n              h(\n                \"Button\",\n                {\n                  props: {\n                    type: \"primary\",\n                    size: \"small\"\n                  },\n                  style: {\n                    marginRight: \"5px\"\n                  },\n                  on: {\n                    click: () => {\n                      // console.log(params.row)\n                      this.boodataAsync = JSON.parse( JSON.stringify(params.row)) ;//深拷贝,防止数据串联修改\n                      this.bookDetail = true;\n                    }\n                  }\n                },\n                \"修改\"\n              ),\n              h(\n                \"Button\",\n                {\n                  props: {\n                    type: \"error\",\n                    size: \"small\"\n                  },\n                  on: {\n                    click: () => {\n                      this.$Modal.confirm({\n                        title: \"提示\",\n                        content: \"<p>你确定要删除吗?</p>\",\n                        onOk: () => {\n                          delBook({ id: params.row.id }).then(res => {\n                            if (res.code == 1) {\n                              this.$Message.success(res.msg);\n                              this.selectAll();\n                            } else {\n                              this.$Message.error(res.msg);\n                            }\n                          });\n                        },\n                        onCancel: () => {}\n                      });\n                    }\n                  }\n                },\n                \"删除\"\n              )\n            ]);\n          }\n        }\n      ],\n      bookdata: [], //当前全部数据\n      showdata: [], //当前页展示数据\n      showAlldata: [], //当前全部展示数据\n\n      //分页\n      currentPage: 1,\n      total: 0,\n      pageSize: 8,\n\n      //筛选\n      typeList: [], //类别列表\n      typeName: null, //类别显示\n      languageList: [], //语言列表\n      languageName: null, //语言显示\n      statusList: [], //状态列表\n      statusName: null, //状态显示\n      bookname: null //搜索书名\n    };\n  },\n  mounted() {\n    this.getBook();\n    window.onresize = () => {\n      this.checkHeight();\n    };\n  },\n  methods: {\n    closeMod() {\n      this.bookDetail = false;\n      this.bookAdd = false;\n    },\n    getBook() {\n      this.closeMod();\n      getBook().then(res => {\n        // console.log(res);\n        this.bookdata = res;\n        this.Initial();\n      });\n    },\n    checkHeight() {\n      var H = document.body.clientHeight;\n      H < 700 ? (this.pageSize = 8) : (this.pageSize = 10);\n      this.changePage(1);\n    },\n    Initial() {\n      this.checkHeight();\n      this.getData(this.bookdata);\n      this.isLoading = false;\n      this.bookdata.map((item, index) => {\n        //类别列表\n        if (this.typeList.indexOf(item.type) == -1) {\n          this.typeList.push(item.type);\n        }\n        //语言列表\n        if (this.languageList.indexOf(item.language) == -1) {\n          this.languageList.push(item.language);\n        }\n        //状态列表\n        if (this.statusList.indexOf(item.status) == -1) {\n          this.statusList.push(item.status);\n        }\n      });\n    },\n    getData(data) {\n      this.showAlldata = data;\n      this.total = this.showAlldata.length;\n      this.currentPage = 1;\n      this.changePage(1);\n    },\n    changePage(index) {\n      var start = (index - 1) * this.pageSize;\n      var end = start + this.pageSize;\n      this.showdata = this.showAlldata.slice(start, end);\n    },\n    selectType(name) {\n      this.InitialList();\n      this.typeName = name;\n      this.getData(this.bookdata.filter(item => item.type == name));\n    },\n    selectLanguage(name) {\n      this.InitialList();\n      this.languageName = name;\n      this.getData(this.bookdata.filter(item => item.language == name));\n    },\n    selectStatus(name) {\n      this.InitialList();\n      this.statusName = name;\n      this.getData(this.bookdata.filter(item => item.status == name));\n    },\n    selectAll() {\n      this.isLoading = true;\n      this.getBook();\n      this.InitialList();\n    },\n    InitialList() {\n      //初始化选择列表项信息\n      this.typeName = null;\n      this.languageName = null;\n      this.statusName = null;\n      this.bookname = null;\n      this.currentPage = 1;\n    },\n    searchName() {\n      if (this.bookname) {\n        let arr = this.bookdata.filter(\n          item => item.name.indexOf(this.bookname) > -1\n        );\n        if (arr.length <= 0) {\n          this.$Message.error(\"没有找到相关书籍!\");\n        } else {\n          this.typeName = null;\n          this.languageName = null;\n          this.statusName = null;\n          this.getData(arr);\n        }\n      } else {\n        this.$Message.error(\"内容为空!\");\n      }\n    }\n  }\n};\n</script>\n\n<style scoped >\n.loading {\n  padding-top: 10%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.demo-spin-col {\n  font-size: 22px;\n  height: 100px;\n  position: relative;\n}\n.demo-spin-icon-load {\n  font-size: 30px;\n  animation: ani-demo-spin 1s linear infinite;\n}\n@keyframes ani-demo-spin {\n  from {\n    transform: rotate(0deg);\n  }\n  50% {\n    transform: rotate(180deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n.main {\n  padding: 10px;\n  box-sizing: border-box;\n}\n.toplist {\n  display: flex;\n}\n.page {\n  text-align: center;\n  margin: 10px 0;\n}\n</style>"]}]}